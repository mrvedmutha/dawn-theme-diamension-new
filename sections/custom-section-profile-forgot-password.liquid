{% comment %}
  Section: Profile Forgot Password
  Purpose: Customer password recovery page with split-screen layout
  Author: Wings Design Team
  Version: 1.0
  Figma Node: Based on 12-5449 (Login) structure
{% endcomment %}

{{ 'section-profile-forgot-password.css' | asset_url | stylesheet_tag }}

{% liquid
  assign section_id = section.id
  assign heading = section.settings.heading
  assign description = section.settings.description
  assign image = section.settings.image
  assign background_color = section.settings.background_color
%}

<div
  class="custom-section-profile-forgot-password"
  data-section-id="{{ section_id }}"
  style="--bg-color: {{ background_color }};"
>
  <div class="custom-section-profile-forgot-password__wrapper">
    {% comment %} Form Section - Left 50% {% endcomment %}
    <div class="custom-section-profile-forgot-password__form-section">
      <div class="custom-section-profile-forgot-password__form-container">
        {% comment %} Heading {% endcomment %}
        <div class="custom-section-profile-forgot-password__header">
          {% if heading != blank %}
            <h1 class="custom-section-profile-forgot-password__heading">
              {{ heading | escape }}
            </h1>
          {% endif %}

          {% if description != blank %}
            <p class="custom-section-profile-forgot-password__description">
              {{ description | escape }}
            </p>
          {% endif %}
        </div>

        {% comment %} Forgot Password Form {% endcomment %}
        <div class="custom-section-profile-forgot-password__form-wrapper">
          {% form 'recover_customer_password' %}
            <div class="custom-section-profile-forgot-password__form">
              {% comment %} TODO: Hidden return_to parameter - Redirect back to show success message {% endcomment %}
              <input type="hidden" name="return_to" value="{{ routes.account_login_url }}?recover_success=true">

              {% if form.posted_successfully? %}
                <div class="custom-section-profile-forgot-password__info">
                  <div class="custom-section-profile-forgot-password__info-title">
                    {{ 'customer.recover_password.success_title' | t }}
                  </div>
                  <div class="custom-section-profile-forgot-password__info-text">
                    {{ 'customer.recover_password.success_message' | t }}
                  </div>
                  <div class="custom-section-profile-forgot-password__info-text">
                    {{ 'customer.recover_password.success_spam_note' | t }}
                  </div>
                </div>
              {% endif %}

              {% if form.errors %}
                <div class="custom-section-profile-forgot-password__errors">
                  {{ form.errors | default_errors }}
                </div>
              {% endif %}

              {% comment %} Email Field {% endcomment %}
              <div class="custom-section-profile-forgot-password__field">
                <input
                  type="email"
                  id="recover-email"
                  name="email"
                  autocomplete="email"
                  placeholder="{{ 'customer.recover_password.email' | t }}"
                  class="custom-section-profile-forgot-password__input"
                  {% if form.email %}
                    value="{{ form.email }}"
                  {% endif %}
                  required
                >
              </div>
              <div class="custom-section-profile-forgot-password__field-line">&nbsp;</div>

              {% comment %} Submit Button {% endcomment %}
              <button type="submit" class="custom-section-profile-forgot-password__button">
                {{ 'customer.recover_password.submit' | t }}
              </button>
            </div>
          {% endform %}
        </div>

        {% comment %} Back to Login Link {% endcomment %}
        <a href="{{ routes.account_login_url }}" class="custom-section-profile-forgot-password__back-link">
          {{ 'customer.recover_password.cancel' | t }}
        </a>
      </div>
    </div>

    {% comment %} Image Section - Right 50% {% endcomment %}
    <div class="custom-section-profile-forgot-password__image-wrapper">
      {% if image != blank %}
        <img
          src="{{ image | image_url: width: 1920 }}"
          srcset="
            {{ image | image_url: width: 750 }} 750w,
            {{ image | image_url: width: 1000 }} 1000w,
            {{ image | image_url: width: 1500 }} 1500w,
            {{ image | image_url: width: 1920 }} 1920w
          "
          sizes="(max-width: 767px) 100vw, 50vw"
          alt="{{ image.alt | default: 'Forgot Password' | escape }}"
          loading="lazy"
          class="custom-section-profile-forgot-password__image"
        >
      {% else %}
        <div class="custom-section-profile-forgot-password__placeholder">&nbsp;</div>
      {% endif %}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Profile Forgot Password",
  "class": "section-profile-forgot-password",
  "settings": [
    {
      "type": "header",
      "content": "Content Settings"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "RESET YOUR PASSWORD"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "We will send you an email to reset your password"
    },
    {
      "type": "header",
      "content": "Visual Settings"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image",
      "info": "Recommended: 720px Ã— 912px for desktop"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#fffaf5"
    }
  ],
  "presets": [
    {
      "name": "Profile Forgot Password",
      "settings": {
        "heading": "RESET YOUR PASSWORD",
        "description": "We will send you an email to reset your password",
        "background_color": "#fffaf5"
      }
    }
  ]
}
{% endschema %}
